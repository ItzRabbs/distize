import { listPackages } from './list-packages'
import { join } from 'path'

const BASE_PATH = join(__dirname, '../..')

describe('testsuite of utils/lit-packages', () => {
  it('test listPackages', async () => {
    const expected = [
      'node_modules/core-js',
    ].map(path => `${BASE_PATH}/${path}`).sort()

    expect((await listPackages()).sort()).toEqual(expected)
    expect((await listPackages({ noDeps: false })).sort()).toEqual(expected)
    expect((await listPackages({ devDeps: false })).sort()).toEqual(expected)
    expect((await listPackages({ noDeps: false, devDeps: false })).sort()).toEqual(expected)
  }, 10000)

  it('test listPackages, noDeps=true', async () => {
    const expected = [
    ].map(path => `${BASE_PATH}/${path}`).sort()

    expect((await listPackages({ noDeps: true })).sort()).toEqual(expected)
    expect((await listPackages({ noDeps: true, devDeps: false })).sort()).toEqual(expected)
  }, 10000)

  it('test listPackages, devDeps=true', async () => {
    const expected = [
      'node_modules/@babel/cli',
      'node_modules/chokidar',
      'node_modules/anymatch',
      'node_modules/micromatch',
      'node_modules/arr-diff',
      'node_modules/define-property',
      'node_modules/extend-shallow',
      'node_modules/assign-symbols',
      'node_modules/is-plain-object',
      'node_modules/extglob',
      'node_modules/expand-brackets',
      'node_modules/posix-character-classes',
      'node_modules/fragment-cache',
      'node_modules/kind-of',
      'node_modules/nanomatch',
      'node_modules/is-windows',
      'node_modules/object.pick',
      'node_modules/regex-not',
      'node_modules/remove-trailing-separator',
      'node_modules/async-each',
      'node_modules/braces',
      'node_modules/arr-flatten',
      'node_modules/array-unique',
      'node_modules/is-extendable',
      'node_modules/fill-range',
      'node_modules/is-number',
      'node_modules/is-buffer',
      'node_modules/repeat-string',
      'node_modules/to-regex-range',
      'node_modules/isobject',
      'node_modules/repeat-element',
      'node_modules/snapdragon',
      'node_modules/base',
      'node_modules/cache-base',
      'node_modules/collection-visit',
      'node_modules/map-visit',
      'node_modules/object-visit',
      'node_modules/get-value',
      'node_modules/has-value',
      'node_modules/has-values',
      'node_modules/set-value',
      'node_modules/to-object-path',
      'node_modules/union-value',
      'node_modules/unset-value',
      'node_modules/class-utils',
      'node_modules/arr-union',
      'node_modules/static-extend',
      'node_modules/object-copy',
      'node_modules/copy-descriptor',
      'node_modules/component-emitter',
      'node_modules/mixin-deep',
      'node_modules/for-in',
      'node_modules/pascalcase',
      'node_modules/is-descriptor',
      'node_modules/is-accessor-descriptor',
      'node_modules/is-data-descriptor',
      'node_modules/map-cache',
      'node_modules/source-map-resolve',
      'node_modules/atob',
      'node_modules/decode-uri-component',
      'node_modules/resolve-url',
      'node_modules/source-map-url',
      'node_modules/urix',
      'node_modules/use',
      'node_modules/snapdragon-node',
      'node_modules/snapdragon-util',
      'node_modules/split-string',
      'node_modules/to-regex',
      'node_modules/safe-regex',
      'node_modules/ret',
      'node_modules/fsevents',
      'node_modules/bindings',
      'node_modules/file-uri-to-path',
      'node_modules/nan',
      'node_modules/glob-parent',
      'node_modules/path-dirname',
      'node_modules/inherits',
      'node_modules/is-binary-path',
      'node_modules/binary-extensions',
      'node_modules/normalize-path',
      'node_modules/path-is-absolute',
      'node_modules/readdirp',
      'node_modules/graceful-fs',
      'node_modules/readable-stream',
      'node_modules/core-util-is',
      'node_modules/process-nextick-args',
      'node_modules/string_decoder',
      'node_modules/util-deprecate',
      'node_modules/upath',
      'node_modules/commander',
      'node_modules/convert-source-map',
      'node_modules/safe-buffer',
      'node_modules/fs-readdir-recursive',
      'node_modules/glob',
      'node_modules/fs.realpath',
      'node_modules/inflight',
      'node_modules/wrappy',
      'node_modules/once',
      'node_modules/lodash',
      'node_modules/make-dir',
      'node_modules/pify',
      'node_modules/slash',
      'node_modules/source-map',
      'node_modules/@babel/core',
      'node_modules/@babel/code-frame',
      'node_modules/@babel/highlight',
      'node_modules/js-tokens',
      'node_modules/@babel/generator',
      'node_modules/jsesc',
      'node_modules/@babel/helpers',
      'node_modules/@babel/parser',
      'node_modules/@babel/template',
      'node_modules/@babel/traverse',
      'node_modules/@babel/helper-function-name',
      'node_modules/@babel/helper-split-export-declaration',
      'node_modules/globals',
      'node_modules/@babel/types',
      'node_modules/to-fast-properties',
      'node_modules/json5',
      'node_modules/minimist',
      'node_modules/resolve',
      'node_modules/path-parse',
      'node_modules/semver',
      'node_modules/@babel/plugin-proposal-class-properties',
      'node_modules/@babel/helper-create-class-features-plugin',
      'node_modules/@babel/helper-member-expression-to-functions',
      'node_modules/@babel/helper-optimise-call-expression',
      'node_modules/@babel/helper-replace-supers',
      'node_modules/@babel/helper-plugin-utils',
      'node_modules/@babel/plugin-proposal-object-rest-spread',
      'node_modules/@babel/plugin-syntax-object-rest-spread',
      'node_modules/@babel/preset-env',
      'node_modules/@babel/helper-module-imports',
      'node_modules/@babel/plugin-proposal-async-generator-functions',
      'node_modules/@babel/helper-remap-async-to-generator',
      'node_modules/@babel/helper-wrap-function',
      'node_modules/@babel/plugin-proposal-dynamic-import',
      'node_modules/@babel/plugin-proposal-json-strings',
      'node_modules/@babel/plugin-proposal-optional-catch-binding',
      'node_modules/@babel/plugin-proposal-unicode-property-regex',
      'node_modules/@babel/helper-create-regexp-features-plugin',
      'node_modules/regexpu-core',
      'node_modules/regenerate',
      'node_modules/regenerate-unicode-properties',
      'node_modules/regjsgen',
      'node_modules/regjsparser',
      'node_modules/unicode-match-property-ecmascript',
      'node_modules/unicode-canonical-property-names-ecmascript',
      'node_modules/unicode-property-aliases-ecmascript',
      'node_modules/unicode-match-property-value-ecmascript',
      'node_modules/@babel/plugin-syntax-async-generators',
      'node_modules/@babel/plugin-syntax-dynamic-import',
      'node_modules/@babel/plugin-syntax-json-strings',
      'node_modules/@babel/plugin-syntax-optional-catch-binding',
      'node_modules/@babel/plugin-syntax-top-level-await',
      'node_modules/@babel/plugin-transform-arrow-functions',
      'node_modules/@babel/plugin-transform-async-to-generator',
      'node_modules/@babel/plugin-transform-block-scoped-functions',
      'node_modules/@babel/plugin-transform-block-scoping',
      'node_modules/@babel/plugin-transform-classes',
      'node_modules/@babel/helper-annotate-as-pure',
      'node_modules/@babel/helper-define-map',
      'node_modules/@babel/plugin-transform-computed-properties',
      'node_modules/@babel/plugin-transform-destructuring',
      'node_modules/@babel/plugin-transform-dotall-regex',
      'node_modules/@babel/plugin-transform-duplicate-keys',
      'node_modules/@babel/plugin-transform-exponentiation-operator',
      'node_modules/@babel/helper-builder-binary-assignment-operator-visitor',
      'node_modules/@babel/helper-explode-assignable-expression',
      'node_modules/@babel/plugin-transform-for-of',
      'node_modules/@babel/plugin-transform-function-name',
      'node_modules/@babel/plugin-transform-literals',
      'node_modules/@babel/plugin-transform-member-expression-literals',
      'node_modules/@babel/plugin-transform-modules-amd',
      'node_modules/@babel/helper-module-transforms',
      'node_modules/babel-plugin-dynamic-import-node',
      'node_modules/object.assign',
      'node_modules/has-symbols',
      'node_modules/object-keys',
      'node_modules/@babel/plugin-transform-modules-commonjs',
      'node_modules/@babel/helper-simple-access',
      'node_modules/@babel/plugin-transform-modules-systemjs',
      'node_modules/@babel/helper-hoist-variables',
      'node_modules/@babel/plugin-transform-modules-umd',
      'node_modules/@babel/plugin-transform-named-capturing-groups-regex',
      'node_modules/@babel/plugin-transform-new-target',
      'node_modules/@babel/plugin-transform-object-super',
      'node_modules/@babel/plugin-transform-parameters',
      'node_modules/@babel/helper-call-delegate',
      'node_modules/@babel/helper-get-function-arity',
      'node_modules/@babel/plugin-transform-property-literals',
      'node_modules/@babel/plugin-transform-regenerator',
      'node_modules/regenerator-transform',
      'node_modules/private',
      'node_modules/@babel/plugin-transform-reserved-words',
      'node_modules/@babel/plugin-transform-shorthand-properties',
      'node_modules/@babel/plugin-transform-spread',
      'node_modules/@babel/plugin-transform-sticky-regex',
      'node_modules/@babel/helper-regex',
      'node_modules/@babel/plugin-transform-template-literals',
      'node_modules/@babel/plugin-transform-typeof-symbol',
      'node_modules/@babel/plugin-transform-unicode-regex',
      'node_modules/browserslist',
      'node_modules/caniuse-lite',
      'node_modules/electron-to-chromium',
      'node_modules/node-releases',
      'node_modules/core-js-compat',
      'node_modules/invariant',
      'node_modules/loose-envify',
      'node_modules/js-levenshtein',
      'node_modules/@babel/preset-typescript',
      'node_modules/@babel/plugin-transform-typescript',
      'node_modules/@babel/plugin-syntax-typescript',
      'node_modules/@stdjs/eslint-config',
      'node_modules/@typescript-eslint/eslint-plugin',
      'node_modules/@typescript-eslint/experimental-utils',
      'node_modules/@types/json-schema',
      'node_modules/eslint-scope',
      'node_modules/tsutils',
      'node_modules/tslib',
      'node_modules/@typescript-eslint/parser',
      'node_modules/@types/eslint-visitor-keys',
      'node_modules/@typescript-eslint/typescript-estree',
      'node_modules/lodash.unescape',
      'node_modules/eslint-plugin-import',
      'node_modules/array-includes',
      'node_modules/define-properties',
      'node_modules/es-abstract',
      'node_modules/es-to-primitive',
      'node_modules/is-date-object',
      'node_modules/is-symbol',
      'node_modules/is-callable',
      'node_modules/is-regex',
      'node_modules/object-inspect',
      'node_modules/string.prototype.trimleft',
      'node_modules/string.prototype.trimright',
      'node_modules/is-string',
      'node_modules/array.prototype.flat',
      'node_modules/contains-path',
      'node_modules/debug',
      'node_modules/ms',
      'node_modules/doctrine',
      'node_modules/isarray',
      'node_modules/eslint-import-resolver-node',
      'node_modules/eslint-module-utils',
      'node_modules/pkg-dir',
      'node_modules/has',
      'node_modules/function-bind',
      'node_modules/object.values',
      'node_modules/read-pkg-up',
      'node_modules/find-up',
      'node_modules/locate-path',
      'node_modules/p-locate',
      'node_modules/p-limit',
      'node_modules/p-try',
      'node_modules/path-exists',
      'node_modules/read-pkg',
      'node_modules/load-json-file',
      'node_modules/parse-json',
      'node_modules/error-ex',
      'node_modules/is-arrayish',
      'node_modules/normalize-package-data',
      'node_modules/hosted-git-info',
      'node_modules/validate-npm-package-license',
      'node_modules/spdx-correct',
      'node_modules/spdx-license-ids',
      'node_modules/spdx-expression-parse',
      'node_modules/spdx-exceptions',
      'node_modules/path-type',
      'node_modules/eslint-plugin-unicorn',
      'node_modules/clean-regexp',
      'node_modules/eslint-ast-utils',
      'node_modules/lodash.get',
      'node_modules/lodash.zip',
      'node_modules/import-modules',
      'node_modules/lodash.camelcase',
      'node_modules/lodash.defaultsdeep',
      'node_modules/lodash.kebabcase',
      'node_modules/lodash.snakecase',
      'node_modules/lodash.topairs',
      'node_modules/lodash.upperfirst',
      'node_modules/reserved-words',
      'node_modules/regexp-tree',
      'node_modules/@types/jest',
      'node_modules/jest-diff',
      'node_modules/diff-sequences',
      'node_modules/jest-get-type',
      'node_modules/pretty-format',
      'node_modules/react-is',
      'node_modules/@types/node',
      'node_modules/core-js',
      'node_modules/eslint',
      'node_modules/ajv',
      'node_modules/fast-deep-equal',
      'node_modules/json-schema-traverse',
      'node_modules/uri-js',
      'node_modules/punycode',
      'node_modules/chalk',
      'node_modules/ansi-styles',
      'node_modules/color-convert',
      'node_modules/color-name',
      'node_modules/escape-string-regexp',
      'node_modules/supports-color',
      'node_modules/has-flag',
      'node_modules/cross-spawn',
      'node_modules/nice-try',
      'node_modules/path-key',
      'node_modules/shebang-command',
      'node_modules/shebang-regex',
      'node_modules/which',
      'node_modules/isexe',
      'node_modules/esrecurse',
      'node_modules/estraverse',
      'node_modules/eslint-utils',
      'node_modules/eslint-visitor-keys',
      'node_modules/espree',
      'node_modules/acorn',
      'node_modules/acorn-jsx',
      'node_modules/esquery',
      'node_modules/esutils',
      'node_modules/file-entry-cache',
      'node_modules/flat-cache',
      'node_modules/flatted',
      'node_modules/write',
      'node_modules/functional-red-black-tree',
      'node_modules/type-fest',
      'node_modules/ignore',
      'node_modules/import-fresh',
      'node_modules/parent-module',
      'node_modules/callsites',
      'node_modules/resolve-from',
      'node_modules/imurmurhash',
      'node_modules/inquirer',
      'node_modules/ansi-escapes',
      'node_modules/cli-cursor',
      'node_modules/restore-cursor',
      'node_modules/onetime',
      'node_modules/mimic-fn',
      'node_modules/signal-exit',
      'node_modules/cli-width',
      'node_modules/external-editor',
      'node_modules/chardet',
      'node_modules/iconv-lite',
      'node_modules/safer-buffer',
      'node_modules/tmp',
      'node_modules/os-tmpdir',
      'node_modules/figures',
      'node_modules/mute-stream',
      'node_modules/run-async',
      'node_modules/is-promise',
      'node_modules/rxjs',
      'node_modules/string-width',
      'node_modules/emoji-regex',
      'node_modules/is-fullwidth-code-point',
      'node_modules/through',
      'node_modules/is-glob',
      'node_modules/is-extglob',
      'node_modules/js-yaml',
      'node_modules/argparse',
      'node_modules/sprintf-js',
      'node_modules/esprima',
      'node_modules/json-stable-stringify-without-jsonify',
      'node_modules/levn',
      'node_modules/prelude-ls',
      'node_modules/type-check',
      'node_modules/minimatch',
      'node_modules/brace-expansion',
      'node_modules/balanced-match',
      'node_modules/concat-map',
      'node_modules/mkdirp',
      'node_modules/natural-compare',
      'node_modules/optionator',
      'node_modules/deep-is',
      'node_modules/fast-levenshtein',
      'node_modules/word-wrap',
      'node_modules/progress',
      'node_modules/regexpp',
      'node_modules/strip-ansi',
      'node_modules/ansi-regex',
      'node_modules/strip-json-comments',
      'node_modules/table',
      'node_modules/slice-ansi',
      'node_modules/astral-regex',
      'node_modules/text-table',
      'node_modules/v8-compile-cache',
      'node_modules/jest',
      'node_modules/import-local',
      'node_modules/resolve-cwd',
      'node_modules/@jest/core',
      'node_modules/@jest/console',
      'node_modules/@jest/reporters',
      'node_modules/@jest/environment',
      'node_modules/istanbul-lib-coverage',
      'node_modules/istanbul-lib-instrument',
      'node_modules/istanbul-lib-report',
      'node_modules/istanbul-lib-source-maps',
      'node_modules/istanbul-reports',
      'node_modules/handlebars',
      'node_modules/neo-async',
      'node_modules/optimist',
      'node_modules/wordwrap',
      'node_modules/uglify-js',
      'node_modules/jest-worker',
      'node_modules/merge-stream',
      'node_modules/node-notifier',
      'node_modules/growly',
      'node_modules/is-wsl',
      'node_modules/shellwords',
      'node_modules/string-length',
      'node_modules/@jest/transform',
      'node_modules/babel-plugin-istanbul',
      'node_modules/test-exclude',
      'node_modules/json-parse-better-errors',
      'node_modules/pirates',
      'node_modules/node-modules-regexp',
      'node_modules/write-file-atomic',
      'node_modules/jest-changed-files',
      'node_modules/execa',
      'node_modules/get-stream',
      'node_modules/pump',
      'node_modules/end-of-stream',
      'node_modules/is-stream',
      'node_modules/npm-run-path',
      'node_modules/p-finally',
      'node_modules/strip-eof',
      'node_modules/throat',
      'node_modules/jest-haste-map',
      'node_modules/fb-watchman',
      'node_modules/bser',
      'node_modules/node-int64',
      'node_modules/jest-serializer',
      'node_modules/sane',
      'node_modules/@cnakazawa/watch',
      'node_modules/capture-exit',
      'node_modules/rsvp',
      'node_modules/exec-sh',
      'node_modules/walker',
      'node_modules/makeerror',
      'node_modules/tmpl',
      'node_modules/jest-message-util',
      'node_modules/@types/stack-utils',
      'node_modules/stack-utils',
      'node_modules/jest-regex-util',
      'node_modules/jest-resolve',
      'node_modules/browser-resolve',
      'node_modules/jest-pnp-resolver',
      'node_modules/jest-resolve-dependencies',
      'node_modules/jest-runner',
      'node_modules/jest-docblock',
      'node_modules/detect-newline',
      'node_modules/jest-leak-detector',
      'node_modules/source-map-support',
      'node_modules/jest-runtime',
      'node_modules/jest-mock',
      'node_modules/strip-bom',
      'node_modules/jest-snapshot',
      'node_modules/expect',
      'node_modules/jest-matcher-utils',
      'node_modules/jest-watcher',
      'node_modules/p-each-series',
      'node_modules/p-reduce',
      'node_modules/@jest/test-result',
      'node_modules/@types/istanbul-lib-coverage',
      'node_modules/@jest/types',
      'node_modules/@types/istanbul-reports',
      'node_modules/@types/istanbul-lib-report',
      'node_modules/@types/yargs',
      'node_modules/@types/yargs-parser',
      'node_modules/exit',
      'node_modules/is-ci',
      'node_modules/ci-info',
      'node_modules/jest-config',
      'node_modules/@jest/test-sequencer',
      'node_modules/babel-jest',
      'node_modules/@types/babel__core',
      'node_modules/@types/babel__generator',
      'node_modules/@types/babel__template',
      'node_modules/@types/babel__traverse',
      'node_modules/babel-preset-jest',
      'node_modules/babel-plugin-jest-hoist',
      'node_modules/jest-environment-jsdom',
      'node_modules/jsdom',
      'node_modules/abab',
      'node_modules/acorn-globals',
      'node_modules/acorn-walk',
      'node_modules/array-equal',
      'node_modules/cssom',
      'node_modules/cssstyle',
      'node_modules/data-urls',
      'node_modules/domexception',
      'node_modules/escodegen',
      'node_modules/html-encoding-sniffer',
      'node_modules/left-pad',
      'node_modules/nwsapi',
      'node_modules/parse5',
      'node_modules/pn',
      'node_modules/request',
      'node_modules/aws-sign2',
      'node_modules/aws4',
      'node_modules/caseless',
      'node_modules/combined-stream',
      'node_modules/delayed-stream',
      'node_modules/extend',
      'node_modules/forever-agent',
      'node_modules/form-data',
      'node_modules/asynckit',
      'node_modules/har-validator',
      'node_modules/har-schema',
      'node_modules/http-signature',
      'node_modules/assert-plus',
      'node_modules/jsprim',
      'node_modules/extsprintf',
      'node_modules/json-schema',
      'node_modules/verror',
      'node_modules/sshpk',
      'node_modules/asn1',
      'node_modules/bcrypt-pbkdf',
      'node_modules/dashdash',
      'node_modules/ecc-jsbn',
      'node_modules/getpass',
      'node_modules/jsbn',
      'node_modules/tweetnacl',
      'node_modules/is-typedarray',
      'node_modules/isstream',
      'node_modules/json-stringify-safe',
      'node_modules/mime-types',
      'node_modules/mime-db',
      'node_modules/oauth-sign',
      'node_modules/performance-now',
      'node_modules/qs',
      'node_modules/tunnel-agent',
      'node_modules/uuid',
      'node_modules/request-promise-native',
      'node_modules/request-promise-core',
      'node_modules/stealthy-require',
      'node_modules/sax',
      'node_modules/symbol-tree',
      'node_modules/tough-cookie',
      'node_modules/psl',
      'node_modules/w3c-hr-time',
      'node_modules/browser-process-hrtime',
      'node_modules/webidl-conversions',
      'node_modules/whatwg-encoding',
      'node_modules/whatwg-mimetype',
      'node_modules/whatwg-url',
      'node_modules/lodash.sortby',
      'node_modules/tr46',
      'node_modules/ws',
      'node_modules/async-limiter',
      'node_modules/xml-name-validator',
      'node_modules/jest-environment-node',
      'node_modules/jest-jasmine2',
      'node_modules/co',
      'node_modules/is-generator-fn',
      'node_modules/jest-each',
      'node_modules/jest-util',
      'node_modules/@jest/fake-timers',
      'node_modules/@jest/source-map',
      'node_modules/jest-validate',
      'node_modules/camelcase',
      'node_modules/leven',
      'node_modules/prompts',
      'node_modules/kleur',
      'node_modules/sisteransi',
      'node_modules/realpath-native',
      'node_modules/util.promisify',
      'node_modules/object.getownpropertydescriptors',
      'node_modules/get-caller-file',
      'node_modules/require-directory',
      'node_modules/require-main-filename',
      'node_modules/set-blocking',
      'node_modules/which-module',
      'node_modules/y18n',
      'node_modules/decamelize',
      'node_modules/rimraf',
      'node_modules/ts-jest',
      'node_modules/bs-logger',
      'node_modules/buffer-from',
      'node_modules/fast-json-stable-stringify',
      'node_modules/lodash.memoize',
      'node_modules/make-error',
      'node_modules/typescript',
    ].map(path => `${BASE_PATH}/${path}`).sort()

    expect((await listPackages({ devDeps: true })).sort()).toEqual(expected)
    expect((await listPackages({ devDeps: true, noDeps: false })).sort()).toEqual(expected)
  }, 10000)
})
